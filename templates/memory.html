{% extends 'base.html' %}

{% block title %}Growth Journal - NeuroMirror‚Ñ¢{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">
        <i class="fas fa-chart-line text-info"></i> Growth Journal
        <small class="text-info">NeuroMirror‚Ñ¢</small>
    </h1>
    <p class="lead">Watch your AI companion evolve from parrot to partner</p>
    
    <!-- NeuroMirror Evolution Progress -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-dark border-secondary">
                <div class="card-header">
                    <h5 class="mb-0 text-info">
                        <i class="fas fa-brain"></i> NeuroMirror‚Ñ¢ Evolution
                    </h5>
                    <small class="text-muted">From Parrot to Partner</small>
                </div>
                <div class="card-body">
                    <div class="learning-container">
                        <div class="row">
                            <div class="col-md-8">
                                <div id="learning-stage" class="h6 text-light mb-2">Learning Stage: Loading...</div>
                                <div class="progress mb-3" style="height: 25px;">
                                    <div id="learning-progress" class="progress-bar bg-info" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div id="stage-capabilities" class="stage-capabilities"></div>
                            </div>
                            <div class="col-md-4">
                                <div class="evolution-stages">
                                    <div class="stage-indicator infant">üçº Infant</div>
                                    <div class="stage-indicator toddler">üöº Toddler</div>
                                    <div class="stage-indicator child active">üßí Child</div>
                                    <div class="stage-indicator adolescent">üßë Adolescent</div>
                                    <div class="stage-indicator adult">üë§ Adult</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs mb-4" id="memory-tabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="timeline-tab" data-bs-toggle="tab" data-bs-target="#timeline" type="button" role="tab" aria-controls="timeline" aria-selected="true">
                <i class="fas fa-clock"></i> Growth Timeline
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="facts-tab" data-bs-toggle="tab" data-bs-target="#facts" type="button" role="tab" aria-controls="facts" aria-selected="false">
                <i class="fas fa-lightbulb"></i> Facts Learned
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="vocabulary-tab" data-bs-toggle="tab" data-bs-target="#vocabulary" type="button" role="tab" aria-controls="vocabulary" aria-selected="false">
                <i class="fas fa-book"></i> Vocabulary
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="emotions-tab" data-bs-toggle="tab" data-bs-target="#emotions" type="button" role="tab" aria-controls="emotions" aria-selected="false">
                <i class="fas fa-smile"></i> Emotions
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="context-tab" data-bs-toggle="tab" data-bs-target="#context" type="button" role="tab" aria-controls="context" aria-selected="false">
                <i class="fas fa-comments"></i> Context
            </button>
        </li>
    </ul>
    
    <!-- Tab Content -->
    <div class="tab-content" id="memory-tab-content">
        <!-- Growth Timeline Tab -->
        <div class="tab-pane fade show active" id="timeline" role="tabpanel" aria-labelledby="timeline-tab">
            <div class="card bg-dark border-secondary">
                <div class="card-header">
                    <h5 class="mb-0 text-light">
                        <i class="fas fa-timeline"></i> Learning Milestones
                    </h5>
                </div>
                <div class="card-body">
                    <div id="growth-timeline" class="timeline-container">
                        <div class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading growth timeline...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Facts Tab -->
        <div class="tab-pane fade" id="facts" role="tabpanel" aria-labelledby="facts-tab">
            <div class="card bg-dark text-light">
                <div class="card-header">
                    <h5>Memory Facts</h5>
                </div>
                <div class="card-body">
                    <div id="facts-container">
                        <div class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading facts...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Vocabulary Tab -->
        <div class="tab-pane fade" id="vocabulary" role="tabpanel" aria-labelledby="vocabulary-tab">
            <div class="card bg-dark text-light">
                <div class="card-header">
                    <h5>Vocabulary Cloud</h5>
                </div>
                <div class="card-body">
                    <div id="vocabulary-container">
                        <div class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading vocabulary...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Emotions Tab -->
        <div class="tab-pane fade" id="emotions" role="tabpanel" aria-labelledby="emotions-tab">
            <div class="card bg-dark text-light">
                <div class="card-header">
                    <h5>Emotion Tracking</h5>
                </div>
                <div class="card-body">
                    <div id="emotions-container">
                        <div class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading emotions...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Context Tab -->
        <div class="tab-pane fade" id="context" role="tabpanel" aria-labelledby="context-tab">
            <div class="card bg-dark text-light">
                <div class="card-header">
                    <h5>Conversation Context</h5>
                </div>
                <div class="card-body">
                    <div id="context-container">
                        <div class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading context...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* NeuroMirror‚Ñ¢ Growth Journal styles */
.evolution-stages {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.stage-indicator {
    padding: 8px 12px;
    border-radius: 20px;
    background-color: rgba(40, 40, 40, 0.5);
    color: #888;
    font-size: 0.9em;
    text-align: center;
    transition: all 0.3s ease;
}

.stage-indicator.active {
    background-color: rgba(13, 202, 240, 0.2);
    color: #0dcaf0;
    border: 1px solid #0dcaf0;
    box-shadow: 0 0 10px rgba(13, 202, 240, 0.3);
}

.stage-indicator.completed {
    background-color: rgba(25, 135, 84, 0.2);
    color: #198754;
    border: 1px solid #198754;
}

/* Growth Timeline styles */
.timeline-container {
    max-height: 400px;
    overflow-y: auto;
}

.timeline-item {
    display: flex;
    align-items: flex-start;
    margin-bottom: 20px;
    padding: 15px;
    border-left: 3px solid #0dcaf0;
    background-color: rgba(20, 20, 20, 0.5);
    border-radius: 0 8px 8px 0;
    position: relative;
}

.timeline-item::before {
    content: '';
    position: absolute;
    left: -8px;
    top: 20px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #0dcaf0;
}

.timeline-icon {
    margin-right: 15px;
    color: #0dcaf0;
    font-size: 1.2em;
}

.timeline-content {
    flex: 1;
}

.timeline-title {
    font-weight: 600;
    color: #fff;
    margin-bottom: 5px;
}

.timeline-description {
    color: #ccc;
    font-size: 0.9em;
    margin-bottom: 5px;
}

.timeline-time {
    color: #888;
    font-size: 0.8em;
}
</style>

<script src="{{ url_for('static', filename='js/learning.js') }}"></script>
<script>
// Add Growth Timeline functionality
document.addEventListener('DOMContentLoaded', function() {
    loadGrowthTimeline();
});

function loadGrowthTimeline() {
    fetch('/api/growth-timeline')
        .then(response => response.json())
        .then(data => {
            displayGrowthTimeline(data);
        })
        .catch(error => {
            console.error('Error loading growth timeline:', error);
            document.getElementById('growth-timeline').innerHTML = 
                '<div class="text-center text-muted">Unable to load timeline data</div>';
        });
}

function displayGrowthTimeline(milestones) {
    const container = document.getElementById('growth-timeline');
    
    if (!milestones || milestones.length === 0) {
        container.innerHTML = `
            <div class="text-center text-muted">
                <i class="fas fa-seedling"></i>
                <p class="mt-2">Your NeuroMirror‚Ñ¢ journey is just beginning!<br>
                Start chatting to see learning milestones appear here.</p>
            </div>
        `;
        return;
    }
    
    let html = '';
    milestones.forEach(milestone => {
        html += `
            <div class="timeline-item">
                <div class="timeline-icon">
                    <i class="${milestone.icon}"></i>
                </div>
                <div class="timeline-content">
                    <div class="timeline-title">${milestone.title}</div>
                    <div class="timeline-description">${milestone.description}</div>
                    <div class="timeline-time">${milestone.time}</div>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}
</script>
{% endblock %}